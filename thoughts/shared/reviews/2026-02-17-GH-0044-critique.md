---
date: 2026-02-17
github_issue: 44
github_url: https://github.com/cdubiel08/ralph-hero/issues/44
plan_document: thoughts/shared/plans/2026-02-17-group-GH-0044-worker-architecture.md
status: approved
type: critique
---

# Plan Critique: Consolidate Agents into Scope-Bounded Workers (Group #44)

## Overall Assessment: APPROVED

The plan is well-structured, technically sound, and implementable. All 8 phases are clearly defined with concrete file paths, code changes, and testable success criteria. The phasing order (additive first, update orchestrators, then cleanup last) ensures a working system at every intermediate commit.

## Completeness Analysis

**All phases defined with clear changes**: YES. Each of the 8 phases specifies exact files to create, modify, or delete, with code blocks showing the expected content.

**Referenced files verified**: All files mentioned in the plan exist in the current codebase:
- 5 agent definitions: `ralph-triager.md`, `ralph-researcher.md`, `ralph-planner.md`, `ralph-advocate.md`, `ralph-implementer.md`
- 6 spawn templates: `triager.md`, `splitter.md`, `researcher.md`, `planner.md`, `reviewer.md`, `implementer.md`
- Both orchestrator skills: `ralph-team/SKILL.md`, `ralph-hero/SKILL.md`
- Both scripts: `ralph-loop.sh`, `ralph-team-loop.sh`
- State machine: `ralph-state-machine.json`
- Conventions: `shared/conventions.md`
- Hook script: `team-task-completed.sh`

## Feasibility Analysis

### Strengths

1. **Sound architectural rationale**: Consolidating 5 specialized agents into 4 scope-bounded workers with broader state ownership reduces handoff boundaries from 6+ to 3. The workers are a natural grouping.

2. **Existing skills preserved unchanged**: The plan correctly identifies that consolidation happens at the agent level, not the skill level. All 6 existing skills (`ralph-triage`, `ralph-split`, `ralph-research`, `ralph-plan`, `ralph-review`, `ralph-impl`) remain unmodified.

3. **Tool list unions are accurate**: Verified against current agent frontmatter:
   - Analyst tool list is the union of `ralph-triager` + `ralph-researcher` tools (adds `Write`, `Bash`, `detect_group`, `remove_dependency` from researcher to triager's set)
   - Builder tool list is the union of `ralph-planner` + `ralph-implementer` tools (adds `Edit` from implementer, adds `detect_group`, `list_sub_issues`, `list_dependencies` from planner)
   - Validator matches `ralph-advocate` exactly
   - Integrator is a new, minimal set appropriate for git/merge operations

4. **Phase 8 self-correction**: The plan identifies and resolves the spawn template deletion conflict inline -- noting that templates are agent-type-agnostic and should NOT be deleted since the Phase 6 spawn table still references them. This shows careful cross-phase analysis.

5. **State machine alignment**: The 11 workflow states in `ralph-state-machine.json` (Backlog, Research Needed, Research in Progress, Ready for Plan, Plan in Progress, Plan in Review, In Progress, In Review, Human Needed, Done, Canceled) are all accounted for in the state ownership map.

### Minor Issues (Non-blocking)

1. **State count discrepancy**: The plan says "11 workflow states" but the state ownership map in Phase 1 only lists 10 explicit assignments (Analyst: 3, Builder: 4, None: 3). The "Plan in Review" dual ownership adds Validator as an observer, making the total consistent if you count Validator's "observes" as partial ownership. This could be clearer in the design doc but is not incorrect.

2. **In Review state dual assignment**: Both Validator ("In Review - future quality gates") and Integrator ("In Review - merge operations") reference the "In Review" state. The plan notes this is intentional (different operations on the same state) but the design doc should document this clearly. Since the Integrator is serialized (one at a time) and the Validator only observes, there's no actual conflict.

3. **Builder model choice**: The plan specifies `model: sonnet` for Builder, noting "Model is sonnet for the thin loop; skills override to opus as needed." This is consistent with the current approach where `ralph-planner` uses `model: opus` but the plan skill itself would handle model selection. However, the current `ralph-planner` agent uses `model: opus` -- the plan is intentionally downgrading the agent's model, relying on skill-level model selection. This is a valid design choice but should be noted as a behavioral change.

4. **`ralph-loop.sh` validator-only flag**: Phase 7 adds `--validator-only` to the review phase condition (line 656: `|| [ "$MODE" = "--validator-only" ]`), which makes the review phase run for `--validator-only`. This is correct since the Validator's only job is review, but the naming is potentially confusing (it runs the same `ralph-review` skill, not a new validator-specific skill).

## Clarity Analysis

**Success criteria are specific and testable**: YES. Every phase has automated verification commands (`test -f`, `grep -q`, `bash -n`) and manual verification checklists. The integration testing section at the end provides a comprehensive final check.

**Scope boundaries are well-defined**: YES. "What We're NOT Doing" is explicit and comprehensive -- no skill changes, no state machine changes, no MCP server code, no new skills, no CI/CD, no hook script changes beyond comments.

## Risk Assessment

**Low risk**: This is primarily a documentation and configuration change (agent `.md` files, orchestrator skill descriptions, shell script flags). No runtime code, no MCP server changes, no state machine changes. The existing skills continue to do the actual work.

**Rollback path**: If any phase fails, the previous phases' files remain valid alongside the old agents until Phase 8 cleanup. The cleanup phase can be deferred if needed.

## Verdict

**APPROVED** -- The plan is thorough, technically accurate, and well-sequenced. The minor issues noted above are documentation clarity items that can be addressed during implementation without changing the plan structure. The phasing ensures a working system at every step.
