---
date: 2026-02-17
github_issue: 53
github_url: https://github.com/cdubiel08/ralph-hero/issues/53
plan_document: thoughts/shared/plans/2026-02-17-GH-0053-template-integrity-enforcement.md
status: approved
type: critique
---

# Plan Critique: GH-53 - Enforce Template Integrity for Teammate Spawning

## Verdict: APPROVED

The plan is well-structured with three complementary layers of defense. All file references are valid, insertion points are correct, and the approach aligns with existing architecture documentation.

## Completeness

- **All 3 phases are clearly defined** with specific file paths, insertion locations, and exact content to add.
- **Success criteria** are concrete: grep-based automated checks for each phase, plus manual verification items.
- **What we're NOT doing** is well-scoped: no template file changes, no postcondition hooks (correctly identified as infeasible), no removal of Skill tool.
- **Testing strategy** includes static verification, line-count checks, and runtime verification.

## Feasibility

All file references verified against the codebase:

| File | Exists | Location claim correct |
|------|--------|----------------------|
| `skills/ralph-team/SKILL.md` | Yes | Insert after L202, before "Per-Role Instance Limits" (L204) -- correct |
| `skills/shared/conventions.md` | Yes | Insert after "Template Authoring Rules" (L233), before "Skill Invocation Convention" (L234) -- correct |
| `agents/ralph-researcher.md` | Yes | Current tool list matches plan exactly |
| `agents/ralph-planner.md` | Yes | Current tool list matches plan exactly |
| `agents/ralph-advocate.md` | Yes | Current tool list matches plan exactly |
| `agents/ralph-implementer.md` | Yes | Current tool list matches plan exactly, retains `Edit` |
| `agents/ralph-triager.md` | Yes | Correctly excluded from changes |
| `templates/spawn/*.md` | Yes (6 files) | Not modified (correct) |

### Phase 3 MCP Tool Removal -- Risk Assessment

The plan correctly identifies that Pipeline Handoff Protocol uses only SDK tools (`TaskList`, `TaskUpdate`, `SendMessage`, `Read`), not `ralph_hero__*` MCP tools. The removal is safe.

Additionally, SKILL.md line 246 already documents the intended state: "Only triager has direct MCP access. Others use skill invocations." Phase 3 enforces what the documentation already prescribes.

## Clarity

- Anti-patterns in Phase 1 and Phase 2 are concrete and actionable (not vague prohibitions).
- The line-count guardrail ("resolved prompt MUST be under 10 lines") provides a measurable compliance check.
- The rationale for each change is well-explained, linking back to the root cause (orchestrator template augmentation).

## Scope

Appropriate for an S-estimate. Three phases across 6 files, all text/config changes (no code modifications). The plan correctly notes coordination needed with GH-52 since both touch agent definition files.

## Minor Observations (Not Blocking)

1. **Phase 2 positioning**: The "Template Integrity" subsection in conventions.md is placed under "Spawn Template Protocol" which is good, but the heading level should be `###` (H3) to match the existing subsection pattern ("Template Authoring Rules" is `###`). The plan's content block uses `###` correctly.

2. **Interaction with GH-52**: GH-52 adds an "SDK Note" section to agent definitions while GH-53 modifies the `tools:` frontmatter line. These changes are in different parts of the files and should not conflict, but the implementation order should be noted. Since GH-52 was approved first, it should be implemented first to avoid rebase issues.

## Conclusion

No blocking issues found. The three-layer defense approach (orchestrator instructions, convention documentation, tool surface reduction) is sound and addresses the root cause through multiple reinforcing signals rather than relying on a single instruction.
