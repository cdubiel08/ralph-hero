---
date: 2026-02-25
github_issue: 398
github_url: https://github.com/cdubiel08/ralph-hero/issues/398
plan_document: thoughts/shared/plans/2026-02-25-get-draft-issue-tool.md
status: approved
type: critique
---

# Plan Critique: GH-398 — `get_draft_issue` MCP Tool

## Summary

The plan proposes adding a `ralph_hero__get_draft_issue` tool to `project-management-tools.ts` that reads the full content (title, body, metadata) of one or more draft issues. It supports both DI_ and PVTI_ ID prefixes, uses GraphQL aliases for batching, and follows existing patterns in the codebase.

## Completeness

**Rating: Strong**

- Single phase with clear scope. All changes are in two files: the tool source and the test file.
- File paths are specific and correct (`project-management-tools.ts`, `project-management-tools.test.ts`).
- The placement location is accurately specified: after `convert_draft_issue` which ends at line 665, before `reorder_item` at line 667.
- Schema, handler logic, edge cases, response shape, and test expectations are all defined.
- Success criteria include both automated checks (build, test, grep) and manual verification steps.

## Feasibility

**Rating: Strong — all technical claims verified**

| Claim | Verified? | Notes |
|-------|-----------|-------|
| Draft tools at lines 445-664 | Yes | `create_draft_issue` starts at 445, `convert_draft_issue` ends at 665 |
| `node()` query pattern at lines 511-527 | Yes | `client.projectQuery` for DI_ resolution confirmed at those lines |
| Test patterns at lines 157-224 | Yes | Draft mutation structure tests at those exact lines |
| `toolSuccess` importable from `types.ts` | Yes | Already imported in `project-management-tools.ts` (line 14) |
| `client.projectQuery()` exists | Yes | Defined in `github-client.ts` at line 216, accepts query string + variables + optional cache options |
| GraphQL alias approach works with `projectQuery` | Yes | `projectQuery` passes raw query strings to `executeGraphQL`, so dynamically built alias queries are supported |

**Minor observation**: The plan proposes `client.projectQuery()` for the combined alias query. Since this is a read-only operation, this is correct. The `projectQuery` method uses the project token (which has project read scope), and the `node()` query works for both DI_ and PVTI_ types. No issues here.

## Clarity

**Rating: Strong**

- The GraphQL fragments for both DI_ and PVTI_ paths are fully spelled out with field selections.
- The response shape is explicitly typed with a TypeScript interface showing all fields.
- Edge cases are enumerated: non-draft PVTI_ items, deleted/invalid IDs, empty input array.
- The "What We're NOT Doing" section clearly scopes out changes to `list_project_items`, higher-order skills, and `bulk_archive` draft handling.

## Scope

**Rating: Appropriate**

- Single tool addition with tests — no changes to existing tools or behavior.
- No schema migrations, no new dependencies, no config changes.
- The exclusion of `list_project_items` body inclusion is well-justified (keep listing concise, use dedicated tool for detail).

## Issues

No blocking issues found.

**Non-blocking observations:**

1. **Field extraction from PVTI_ response**: The plan shows extracting `workflowState`, `estimate`, and `priority` from `fieldValues` but does not detail the field-name matching logic (iterating `fieldValues.nodes` and matching `field.name`). This is straightforward to implement but the builder should reference the existing `fieldValues` extraction pattern in `project-tools.ts` (around the `list_project_items` formatter).

2. **`ProjectV2FieldCommon` fragment**: The plan uses `field { ... on ProjectV2FieldCommon { name } }` which is correct for single-select fields. However, if Estimate or Priority use different field types (e.g., `ProjectV2IterationField`), the fragment may miss them. In practice, Ralph's configured fields are all single-select, so this is not a blocking concern.

3. **Caching**: The plan does not mention whether to use `projectQuery`'s cache option. For a read-only tool, short-lived caching (e.g., 30s) could reduce redundant calls when an agent fetches the same draft multiple times. This is an enhancement, not a requirement.

## Verdict

**APPROVED** — The plan is complete, technically accurate, and well-scoped. All referenced files, line numbers, patterns, and APIs have been verified against the current codebase. The implementation should proceed as specified.
