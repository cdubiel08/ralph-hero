---
date: 2026-02-27
github_issue: 456
github_url: https://github.com/cdubiel08/ralph-hero/issues/456
plan_document: thoughts/shared/plans/2026-02-27-GH-0456-update-skills-agents-justfile.md
status: approved
type: critique
---

# GH-456 Plan Critique: Update Skills, Agents, and Justfile

## Summary

The plan is a well-structured, systematic find-and-replace across 19 consumer files (~70 replacements) to update stale tool references after Phases 1-4 consolidated the MCP server toolset. The plan is **approved** with one correction required during implementation.

## Verification Results

### File Existence (19/19 confirmed)

All 19 files listed in the plan exist in the repository:

1. `plugin/ralph-hero/skills/shared/conventions.md` -- exists
2. `plugin/ralph-hero/skills/ralph-triage/SKILL.md` -- exists
3. `plugin/ralph-hero/skills/ralph-split/SKILL.md` -- exists
4. `plugin/ralph-hero/skills/ralph-research/SKILL.md` -- exists
5. `plugin/ralph-hero/skills/ralph-plan/SKILL.md` -- exists
6. `plugin/ralph-hero/skills/ralph-impl/SKILL.md` -- exists
7. `plugin/ralph-hero/skills/ralph-review/SKILL.md` -- exists
8. `plugin/ralph-hero/skills/ralph-pr/SKILL.md` -- exists
9. `plugin/ralph-hero/skills/ralph-merge/SKILL.md` -- exists
10. `plugin/ralph-hero/skills/ralph-hero/SKILL.md` -- exists
11. `plugin/ralph-hero/skills/ralph-hygiene/SKILL.md` -- exists
12. `plugin/ralph-hero/skills/form-idea/SKILL.md` -- exists
13. `plugin/ralph-hero/skills/iterate-plan/SKILL.md` -- exists
14. `plugin/ralph-hero/skills/implement-plan/SKILL.md` -- exists
15. `plugin/ralph-hero/skills/create-plan/SKILL.md` -- exists
16. `plugin/ralph-hero/skills/ralph-setup/SKILL.md` -- exists
17. `plugin/ralph-hero/agents/ralph-analyst.md` -- exists
18. `plugin/ralph-hero/agents/ralph-integrator.md` -- exists
19. `plugin/ralph-hero/justfile` -- exists

### Line Reference Spot-Checks (all confirmed)

- **ralph-triage/SKILL.md line 17**: Confirmed `matcher: "ralph_hero__update_workflow_state"` -- matches plan
- **shared/conventions.md line 71**: Confirmed `ralph_hero__update_workflow_state(number, state="__ESCALATE__", command="[current-command]")` -- matches plan
- **ralph-pr/SKILL.md line 12**: Confirmed `matcher: "ralph_hero__update_workflow_state|ralph_hero__advance_children"` -- matches plan
- **justfile line 272/276**: Confirmed `update_workflow_state` in approve recipe prompt and `run_quick` call -- matches plan
- **justfile line 354**: Confirmed `run_quick "ralph_hero__list_dependencies"` in deps recipe -- matches plan
- **justfile line 369**: Confirmed `run_quick "ralph_hero__detect_pipeline_position"` in where recipe -- matches plan
- **justfile lines 625/637**: Confirmed deprecated `quick-move` and `quick-assign` recipes reference old tool names -- matches plan
- **ralph-hygiene/SKILL.md line 87**: Confirmed `ralph_hero__archive_item` reference -- matches plan
- **ralph-analyst.md line 4**: Confirmed old tool names in `tools:` list -- matches plan
- **ralph-integrator.md line 4/9**: Confirmed old tool names in `tools:` and `matcher:` -- matches plan
- **ralph-setup/SKILL.md line 197**: Confirmed `ralph_hero__update_field_options` reference -- matches plan
- **ralph-setup/SKILL.md line 436**: Confirmed `ralph_hero__configure_routing` reference -- matches plan

### New Tool Name Verification (3/4 confirmed, 1 needs correction)

Verified against MCP server source in `plugin/ralph-hero/mcp-server/src/tools/`:

| Tool Name | Registered? | Location |
|-----------|-------------|----------|
| `ralph_hero__save_issue` | Yes | `issue-tools.ts:1095` |
| `ralph_hero__advance_issue` | Yes | `relationship-tools.ts:452` |
| `ralph_hero__detect_stream_positions` | Yes | `dashboard-tools.ts:479` |
| `ralph_hero__get_issue` (with `includePipeline`) | Yes | `issue-tools.ts:456`, param at line 477 |
| `ralph_hero__bulk_archive` | **NO -- does not exist** | See correction below |

### Parameter Name Changes (confirmed)

- `update_workflow_state` uses `state=` -> `save_issue` uses `workflowState=` -- confirmed in source
- `advance_children` uses `parentNumber=` -> `advance_issue` uses `number=` + `direction="children"` -- confirmed
- `advance_parent` uses `childNumber=` -> `advance_issue` uses `number=` + `direction="parent"` -- confirmed

## Issues Found

### Issue 1: Wrong tool name for archive replacement (Minor, non-blocking)

**Section**: "11. Update ralph-hygiene skill" and "Replacement Patterns" table (line 94 of plan)

**Problem**: The plan states:
```
ralph_hero__archive_item â†’ ralph_hero__bulk_archive(number=N)
```

But `ralph_hero__bulk_archive` does not exist as a registered tool. In GH-454, `archive_item` and `bulk_archive` were **merged** into `ralph_hero__archive_items` (plural). The test suite explicitly asserts this:

```typescript
// bulk-archive.test.ts line 210-211
it("standalone bulk_archive tool is removed", () => {
    expect(pmToolsSrc).not.toContain("ralph_hero__bulk_archive");
});
it("tool is registered as ralph_hero__archive_items", () => {
    expect(pmToolsSrc).toContain("ralph_hero__archive_items");
});
```

**Correction**: Replace `ralph_hero__bulk_archive(number=N)` with `ralph_hero__archive_items(numbers=[N])` (note: plural name, and `numbers` parameter takes an array).

**Impact**: 1 file affected (ralph-hygiene/SKILL.md line 87), 1 entry in the replacement patterns table. This is a trivial fix during implementation.

## Assessment

### Completeness: Strong
All 19 files are enumerated with specific line numbers and replacement patterns. The stale reference inventory is thorough with counts by tool name and by file. The "Files with NO stale references" list is a nice touch for completeness.

### Feasibility: Strong
Every referenced file exists. Line numbers are accurate (spot-checked 12 references, all correct). The replacement patterns are mechanically straightforward. The one tool name error (bulk_archive vs archive_items) is minor.

### Clarity: Strong
Success criteria include both automated grep verification (comprehensive pattern covering all 30+ old tool names) and manual smoke tests (4 justfile recipes). The grep pattern is specific and testable. The implementation notes section covers key gotchas (parameter name changes, matcher frontmatter importance).

### Scope: Well-defined
"What we're NOT doing" clearly excludes CLAUDE.md documentation (Phase 6) and MCP server changes (Phases 1-4). The ralph-setup special handling is appropriately called out as the only non-mechanical update.

## Verdict: APPROVED

The plan is thorough, accurate, and well-structured for a mechanical find-and-replace task. The single tool name error (`bulk_archive` should be `archive_items`) is minor and easily corrected during implementation. All other technical claims are verified against the codebase.
